nohup: ignoring input
WARNING:root:Limited tf.compat.v2.summary API due to missing TensorBoard installation.
ori_data shape is  (2610, 28)
energy_ep dataset is ready.
ori_data [0] shape is:  (24, 1)
ori_data save shape is:  (72436, 24, 1)
energy_ep dataset is saved.
Start Embedding Network Training
step: 0/50000, e_loss: 0.2383
step: 1000/50000, e_loss: 0.0107
step: 2000/50000, e_loss: 0.0079
step: 3000/50000, e_loss: 0.004
step: 4000/50000, e_loss: 0.0042
step: 5000/50000, e_loss: 0.0046
step: 6000/50000, e_loss: 0.0017
step: 7000/50000, e_loss: 0.0049
step: 8000/50000, e_loss: 0.0048
step: 9000/50000, e_loss: 0.0029
step: 10000/50000, e_loss: 0.0032
step: 11000/50000, e_loss: 0.0061
step: 12000/50000, e_loss: 0.0025
step: 13000/50000, e_loss: 0.0038
step: 14000/50000, e_loss: 0.0023
step: 15000/50000, e_loss: 0.0024
step: 16000/50000, e_loss: 0.0023
step: 17000/50000, e_loss: 0.0022
step: 18000/50000, e_loss: 0.0032
step: 19000/50000, e_loss: 0.0024
step: 20000/50000, e_loss: 0.0022
step: 21000/50000, e_loss: 0.0025
step: 22000/50000, e_loss: 0.0019
step: 23000/50000, e_loss: 0.0035
step: 24000/50000, e_loss: 0.0037
step: 25000/50000, e_loss: 0.0037
step: 26000/50000, e_loss: 0.0023
step: 27000/50000, e_loss: 0.003
step: 28000/50000, e_loss: 0.0026
step: 29000/50000, e_loss: 0.0021
step: 30000/50000, e_loss: 0.0014
step: 31000/50000, e_loss: 0.0049
step: 32000/50000, e_loss: 0.0013
step: 33000/50000, e_loss: 0.0026
step: 34000/50000, e_loss: 0.0011
step: 35000/50000, e_loss: 0.0027
step: 36000/50000, e_loss: 0.0015
step: 37000/50000, e_loss: 0.0035
step: 38000/50000, e_loss: 0.0011
step: 39000/50000, e_loss: 0.0014
step: 40000/50000, e_loss: 0.0025
step: 41000/50000, e_loss: 0.0009
step: 42000/50000, e_loss: 0.0016
step: 43000/50000, e_loss: 0.0027
step: 44000/50000, e_loss: 0.0018
step: 45000/50000, e_loss: 0.0015
step: 46000/50000, e_loss: 0.0015
step: 47000/50000, e_loss: 0.0017
step: 48000/50000, e_loss: 0.0025
step: 49000/50000, e_loss: 0.0022
Finish Embedding Network Training
Start Training with Supervised Loss Only
step: 0/50000, s_loss: 0.3087
step: 1000/50000, s_loss: 0.0822
step: 2000/50000, s_loss: 0.0762
step: 3000/50000, s_loss: 0.083
step: 4000/50000, s_loss: 0.078
step: 5000/50000, s_loss: 0.0981
step: 6000/50000, s_loss: 0.0687
step: 7000/50000, s_loss: 0.0953
step: 8000/50000, s_loss: 0.0766
step: 9000/50000, s_loss: 0.09
step: 10000/50000, s_loss: 0.0925
step: 11000/50000, s_loss: 0.0797
step: 12000/50000, s_loss: 0.068
step: 13000/50000, s_loss: 0.0713
step: 14000/50000, s_loss: 0.0685
step: 15000/50000, s_loss: 0.0714
step: 16000/50000, s_loss: 0.0654
step: 17000/50000, s_loss: 0.0568
step: 18000/50000, s_loss: 0.0549
step: 19000/50000, s_loss: 0.0612
step: 20000/50000, s_loss: 0.0721
step: 21000/50000, s_loss: 0.0748
step: 22000/50000, s_loss: 0.0637
step: 23000/50000, s_loss: 0.0666
step: 24000/50000, s_loss: 0.0537
step: 25000/50000, s_loss: 0.0685
step: 26000/50000, s_loss: 0.0637
step: 27000/50000, s_loss: 0.0616
step: 28000/50000, s_loss: 0.0638
step: 29000/50000, s_loss: 0.0628
step: 30000/50000, s_loss: 0.0661
step: 31000/50000, s_loss: 0.0688
step: 32000/50000, s_loss: 0.0631
step: 33000/50000, s_loss: 0.0651
step: 34000/50000, s_loss: 0.0634
step: 35000/50000, s_loss: 0.0662
step: 36000/50000, s_loss: 0.065
step: 37000/50000, s_loss: 0.0627
step: 38000/50000, s_loss: 0.0539
step: 39000/50000, s_loss: 0.0639
step: 40000/50000, s_loss: 0.0614
step: 41000/50000, s_loss: 0.0683
step: 42000/50000, s_loss: 0.0551
step: 43000/50000, s_loss: 0.0587
step: 44000/50000, s_loss: 0.0524
step: 45000/50000, s_loss: 0.0482
step: 46000/50000, s_loss: 0.0499
step: 47000/50000, s_loss: 0.0572
step: 48000/50000, s_loss: 0.0617
step: 49000/50000, s_loss: 0.0629
Finish Training with Supervised Loss Only
Start Joint Training
step: 0/50000, d_loss: 2.0611, g_loss_u: 0.712, g_loss_s: 0.0517, g_loss_v: 0.2711, e_loss_t0: 0.0282
step: 1000/50000, d_loss: 1.0014, g_loss_u: 1.8428, g_loss_s: 0.061, g_loss_v: 0.0356, e_loss_t0: 0.0025
step: 2000/50000, d_loss: 1.3603, g_loss_u: 1.3238, g_loss_s: 0.0594, g_loss_v: 0.0304, e_loss_t0: 0.0016
step: 3000/50000, d_loss: 1.4355, g_loss_u: 1.2033, g_loss_s: 0.0595, g_loss_v: 0.0312, e_loss_t0: 0.0011
step: 4000/50000, d_loss: 1.5913, g_loss_u: 1.2514, g_loss_s: 0.06, g_loss_v: 0.0169, e_loss_t0: 0.0006
step: 5000/50000, d_loss: 1.677, g_loss_u: 1.0953, g_loss_s: 0.0598, g_loss_v: 0.0255, e_loss_t0: 0.0015
step: 6000/50000, d_loss: 1.6858, g_loss_u: 1.2437, g_loss_s: 0.0665, g_loss_v: 0.0171, e_loss_t0: 0.0021
step: 7000/50000, d_loss: 1.6732, g_loss_u: 1.2958, g_loss_s: 0.0593, g_loss_v: 0.0296, e_loss_t0: 0.0013
step: 8000/50000, d_loss: 1.6111, g_loss_u: 1.39, g_loss_s: 0.0602, g_loss_v: 0.0317, e_loss_t0: 0.0009
step: 9000/50000, d_loss: 1.4585, g_loss_u: 1.3566, g_loss_s: 0.0507, g_loss_v: 0.046, e_loss_t0: 0.0008
step: 10000/50000, d_loss: 1.5249, g_loss_u: 1.5474, g_loss_s: 0.068, g_loss_v: 0.0272, e_loss_t0: 0.0008
step: 11000/50000, d_loss: 1.566, g_loss_u: 1.2401, g_loss_s: 0.0675, g_loss_v: 0.019, e_loss_t0: 0.0017
step: 12000/50000, d_loss: 1.5443, g_loss_u: 1.4194, g_loss_s: 0.0646, g_loss_v: 0.0283, e_loss_t0: 0.0011
step: 13000/50000, d_loss: 1.4445, g_loss_u: 1.5103, g_loss_s: 0.0605, g_loss_v: 0.0545, e_loss_t0: 0.0019
step: 14000/50000, d_loss: 1.483, g_loss_u: 1.4018, g_loss_s: 0.055, g_loss_v: 0.0609, e_loss_t0: 0.0015
step: 15000/50000, d_loss: 1.4594, g_loss_u: 1.5619, g_loss_s: 0.0688, g_loss_v: 0.0716, e_loss_t0: 0.0018
step: 16000/50000, d_loss: 1.5081, g_loss_u: 1.4441, g_loss_s: 0.0543, g_loss_v: 0.0392, e_loss_t0: 0.0017
step: 17000/50000, d_loss: 1.3857, g_loss_u: 1.6807, g_loss_s: 0.065, g_loss_v: 0.049, e_loss_t0: 0.0013
step: 18000/50000, d_loss: 1.4275, g_loss_u: 1.4626, g_loss_s: 0.0711, g_loss_v: 0.0423, e_loss_t0: 0.0006
step: 19000/50000, d_loss: 1.3324, g_loss_u: 1.4963, g_loss_s: 0.0515, g_loss_v: 0.0402, e_loss_t0: 0.0016
step: 20000/50000, d_loss: 1.3597, g_loss_u: 1.4855, g_loss_s: 0.065, g_loss_v: 0.056, e_loss_t0: 0.0013
step: 21000/50000, d_loss: 1.4625, g_loss_u: 1.6328, g_loss_s: 0.0676, g_loss_v: 0.0194, e_loss_t0: 0.0015
step: 22000/50000, d_loss: 1.4768, g_loss_u: 1.2738, g_loss_s: 0.0627, g_loss_v: 0.032, e_loss_t0: 0.0012
step: 23000/50000, d_loss: 1.5103, g_loss_u: 1.6237, g_loss_s: 0.0595, g_loss_v: 0.0396, e_loss_t0: 0.0017
step: 24000/50000, d_loss: 1.867, g_loss_u: 1.5167, g_loss_s: 0.0722, g_loss_v: 0.0206, e_loss_t0: 0.0014
step: 25000/50000, d_loss: 1.5935, g_loss_u: 1.6151, g_loss_s: 0.0507, g_loss_v: 0.0208, e_loss_t0: 0.0011
step: 26000/50000, d_loss: 1.3497, g_loss_u: 1.4021, g_loss_s: 0.0541, g_loss_v: 0.0511, e_loss_t0: 0.0015
step: 27000/50000, d_loss: 1.5276, g_loss_u: 1.5403, g_loss_s: 0.0644, g_loss_v: 0.0169, e_loss_t0: 0.0008
step: 28000/50000, d_loss: 1.4883, g_loss_u: 1.538, g_loss_s: 0.0677, g_loss_v: 0.0639, e_loss_t0: 0.0012
step: 29000/50000, d_loss: 1.6322, g_loss_u: 1.5007, g_loss_s: 0.0624, g_loss_v: 0.0738, e_loss_t0: 0.0007
step: 30000/50000, d_loss: 1.4279, g_loss_u: 1.5158, g_loss_s: 0.0586, g_loss_v: 0.0201, e_loss_t0: 0.0013
step: 31000/50000, d_loss: 1.5849, g_loss_u: 1.2814, g_loss_s: 0.0606, g_loss_v: 0.0248, e_loss_t0: 0.0016
step: 32000/50000, d_loss: 1.6191, g_loss_u: 1.5666, g_loss_s: 0.0712, g_loss_v: 0.1141, e_loss_t0: 0.0018
step: 33000/50000, d_loss: 1.4772, g_loss_u: 1.4832, g_loss_s: 0.0552, g_loss_v: 0.055, e_loss_t0: 0.0021
step: 34000/50000, d_loss: 1.6564, g_loss_u: 1.6348, g_loss_s: 0.0662, g_loss_v: 0.0265, e_loss_t0: 0.0019
step: 35000/50000, d_loss: 1.5354, g_loss_u: 1.5437, g_loss_s: 0.0627, g_loss_v: 0.0584, e_loss_t0: 0.0008
step: 36000/50000, d_loss: 1.418, g_loss_u: 1.3575, g_loss_s: 0.057, g_loss_v: 0.0488, e_loss_t0: 0.0009
step: 37000/50000, d_loss: 1.5094, g_loss_u: 1.2869, g_loss_s: 0.0607, g_loss_v: 0.0181, e_loss_t0: 0.0012
step: 38000/50000, d_loss: 1.657, g_loss_u: 1.4852, g_loss_s: 0.0585, g_loss_v: 0.0571, e_loss_t0: 0.0011
step: 39000/50000, d_loss: 1.4539, g_loss_u: 1.4812, g_loss_s: 0.0684, g_loss_v: 0.0505, e_loss_t0: 0.0016
step: 40000/50000, d_loss: 1.6033, g_loss_u: 1.4815, g_loss_s: 0.0559, g_loss_v: 0.0685, e_loss_t0: 0.0012
step: 41000/50000, d_loss: 1.5199, g_loss_u: 1.5274, g_loss_s: 0.0622, g_loss_v: 0.0386, e_loss_t0: 0.0026
step: 42000/50000, d_loss: 1.3956, g_loss_u: 1.575, g_loss_s: 0.0603, g_loss_v: 0.0391, e_loss_t0: 0.0014
step: 43000/50000, d_loss: 1.3545, g_loss_u: 1.4675, g_loss_s: 0.0657, g_loss_v: 0.0721, e_loss_t0: 0.0015
step: 44000/50000, d_loss: 1.4373, g_loss_u: 1.5529, g_loss_s: 0.0652, g_loss_v: 0.0417, e_loss_t0: 0.0013
step: 45000/50000, d_loss: 1.3928, g_loss_u: 1.4836, g_loss_s: 0.0638, g_loss_v: 0.048, e_loss_t0: 0.0009
step: 46000/50000, d_loss: 1.5492, g_loss_u: 1.485, g_loss_s: 0.0611, g_loss_v: 0.0237, e_loss_t0: 0.0009
step: 47000/50000, d_loss: 1.4778, g_loss_u: 1.4727, g_loss_s: 0.0604, g_loss_v: 0.0422, e_loss_t0: 0.0007
step: 48000/50000, d_loss: 1.4451, g_loss_u: 1.5435, g_loss_s: 0.0559, g_loss_v: 0.0283, e_loss_t0: 0.0013
step: 49000/50000, d_loss: 1.4802, g_loss_u: 1.6591, g_loss_s: 0.062, g_loss_v: 0.0323, e_loss_t0: 0.0015
Finish Joint Training
Finish Synthetic Data Generation
generated_data shape is  (72436, 24, 1)
Finished saving generated data energy_ep
[t-SNE] Computing 121 nearest neighbors...
[t-SNE] Indexed 2000 samples in 0.002s...
/mnt/data728/duyin/anaconda3/envs/tf/lib/python3.7/site-packages/sklearn/neighbors/base.py:441: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
  old_joblib = LooseVersion(joblib_version) < LooseVersion('0.12')
/mnt/data728/duyin/anaconda3/envs/tf/lib/python3.7/site-packages/sklearn/neighbors/base.py:441: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
  old_joblib = LooseVersion(joblib_version) < LooseVersion('0.12')
[t-SNE] Computed neighbors for 2000 samples in 0.214s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2000
[t-SNE] Computed conditional probabilities for sample 2000 / 2000
[t-SNE] Mean sigma: 0.104993
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.609913
[t-SNE] KL divergence after 300 iterations: 1.030333
{'discriminative': 0.07961416344561016, 'predictive': 0.18947447547729432}
Total execution time: 42795.67 seconds
